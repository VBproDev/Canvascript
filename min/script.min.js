"use strict";const{isArray:A}=Array;const _=a=>typeof a==='number';var c=document.querySelector('.canvas'),d=document.querySelector('.reset'),B=document.querySelector('.generate'),f=document.querySelector('.undo'),g=document.querySelector('.setBtn'),h=c.getContext('2d'),I=document.querySelector('.design'),j=document.querySelector('.user-design'),k=document.querySelector('.save'),l=document.querySelector('.curve-input-container'),m=localStorage.getItem('canvasArray'),N=e=>{aB();aF();aC();X(e)};let o='1';let p='#000000';let q;let r;let x;let y;let u=-1;let v=[];let w=!1;function X(C){h&&(h.beginPath(),h.strokeStyle=p,h.lineWidth=+o,h.moveTo(x,y),h.lineTo(C.offsetX,C.offsetY),h.stroke());}function Y(n){return _(n)}function z(){v.length===0?I.value='[ ]':I.value=JSON.stringify(v);;I.select()}function aA(){var _a=v[v.length-1];if(Y(_a)){for(let i=0;i<4;i++)v.pop();;u-=4}else A(_a)&&(v.pop(),u--);};function aB(){h===null||h===void 0?void 0:h.clearRect(0,0,c.width,c.height)};function aC(){let i=0;if(h){h.beginPath();h.strokeStyle='#000000';h.lineWidth=1;while (i<v.length) {let D=v[i];let _b=v[i+1];if(Y(D)&&Y(_b)){h.moveTo(+D,+_b);h.lineTo(+v[i+2],+v[i+3]);i+=4}else if(A(D)){h.moveTo(D[0],D[1]);h.quadraticCurveTo(D[2],D[3],D[4],D[5]);i++}else{if(!(Y(D)||Y(_b))&&!A(_b)){h.stroke();h.beginPath();h.strokeStyle=`${D}`;h.lineWidth=+_b;i+=2}else{Math.sign(+D)?(h.stroke(),h.beginPath(),h.lineWidth=+D,i++):(h.stroke(),h.beginPath(),h.strokeStyle=`${D}`,i++);}}};h.stroke()}};function aD(){var _A=document.querySelector('.space'),_B=document.createRange(),_c=window.getSelection();let i=0;if(_A){_A.innerHTML='';_A.innerHTML+=`<div>const canvas = document.querySelector(\'canvas\');</div><div>const ctx = canvas.getContext(\'2d\');</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '#000000';</div><div>ctx.lineWidth = 1;</div>`;while (i<v.length) {let E=v[i];let aH=v[i+1];if(Y(E)&&Y(aH)){_A.innerHTML+=`<div>ctx.moveTo(${E}, ${aH});</div>`;_A.innerHTML+=`<div>ctx.lineTo(${v[i+2]}, ${v[i+3]});</div>`;i+=4}else if(A(E)){_A.innerHTML+=`<div>ctx.moveTo(${E[0]}, ${E[1]});</div>`;_A.innerHTML+=`<div>ctx.quadraticCurveTo(${E[2]}, ${E[3]}, ${E[4]}, ${E[5]});</div>`;i++}else{if(!(Y(E)||Y(aH))&&!A(aH)){_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '${E}';</div>`;_A.innerHTML+=`<div>ctx.lineWidth = '${aH}';</div>`;i+=2}else{Math.sign(+E)?(_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.lineWidth = '${E}';</div>`,i++):(_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '${E}';</div>`,i++);}}};_A.innerHTML+='<div>ctx.stroke();</div>';_c===null||_c===void 0?void 0:_c.removeAllRanges();_B.selectNodeContents(_A);_c===null||_c===void 0?void 0:_c.addRange(_B)}};function aE(aI,...aJ){if(aI==='def'){var _C=window.innerHeight,_d=window.innerWidth;c.width=(_d/100)*70;c.height=(_C/100)*72.5}else{c.width=aJ[0];c.height=aJ[1]}}function aF(){var aK=2.5*parseFloat(getComputedStyle(document.documentElement).fontSize);q=+document.querySelector('.width').value||c.width;r=+document.querySelector('.height').value||c.height;if(h){h.beginPath();h.strokeStyle='#AAAAAA';h.lineWidth=1;for(let x=0;x<=q;x+=aK){h.moveTo(x,0);h.lineTo(x,r)}for(let y=0;y<=r;y+=aK){h.moveTo(0,y);h.lineTo(q,y)}h.stroke()}};function aG(){var aL=document.querySelector('.curveX'),aM=document.querySelector('.curveY'),aN=v[v.length-1];let _D=[];if(v.length!==0){if(Y(aN)){for(let i=0;i<4;i++)_D.push(v.pop());;u=u-3;_D.reverse()};if(A(aN)){for(let i=0;i<4;i++)_D.push(aN[i]);;v.pop()};_D.push((c.width/100)* +aL.value);_D.push((c.height/100)* +aM.value);v.push(_D)}};aE('def');aF();m!==null&&(v=JSON.parse(m),aC());z();window.addEventListener('resize',e=>{q=+document.querySelector('.width').value;r=+document.querySelector('.height').value;!(q&&r)?aE('def'):aE('custom',q,r);aB();aF();aC()});window.addEventListener('beforeunload',e=>{(localStorage.getItem('canvasArray')!==JSON.stringify(v)&&!w)&&(e.preventDefault(),w=!0)});c.addEventListener('contextmenu',e=>e.preventDefault());c.addEventListener('pointerdown',e=>{var aO=document.querySelector('.stroke-width').value,aP=document.querySelector('.color').value;aP!==p&&(p=aP,u++,v[u]=p);(aO&&aO!==o)&&(o=aO,u++,v[u]=o);x=Math.round(e.offsetX);y=Math.round(e.offsetY);u++;v[u]=x;u++;v[u]=y;c.addEventListener('pointermove',N)});c.addEventListener('pointerup',e=>{let a=Math.round(e.offsetX);let b=Math.round(e.offsetY);aB();aF();aC();c.removeEventListener('pointermove',N);u++;v[u]=a;u++;v[u]=b;h&&(h.beginPath(),h.strokeStyle=p,h.lineWidth=+o,h.moveTo(x,y),h.lineTo(a,b),h.stroke());;z()});f===null||f===void 0?void 0:f.addEventListener('click',()=>{aB();aA();aF();aC();z()});B===null||B===void 0?void 0:B.addEventListener('click',()=>aD());d===null||d===void 0?void 0:d.addEventListener('click',()=>{aB();aF();v=[];u=-1;localStorage.removeItem('canvasArray');o='1';p='#000000';z()});g===null||g===void 0?void 0:g.addEventListener('click',()=>{q=+document.querySelector('.width').value;r=+document.querySelector('.height').value;aE('custom',q,r);aF();aC()});k===null||k===void 0?void 0:k.addEventListener('click',()=>localStorage.setItem('canvasArray',JSON.stringify(v)));j===null||j===void 0?void 0:j.addEventListener('click',()=>{aB();v=JSON.parse(document.querySelector('.design').value);aF();aC();z()});l.addEventListener('input',e=>{var aQ=e.target,aR=aQ.value;if(aQ.classList.contains('curveX')){var aS=document.querySelector('.curveXupdate');aS.innerHTML=aR}else{var _e=document.querySelector('.curveYupdate');_e.innerHTML=aR};aB();aF();aG();aC();z()});